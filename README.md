# ffd

##  *BEWARE* An Important "Gotcha"
The short of it: if there are no flares in your dataset but you are using a prior on a to constrain the rate constant, C, and all derived quantities, be careful! In this case, C, and similar derived values like flare rates, will appear to have real lower and upper bounds in log-space, but this is not true! This is simply a consequence of the impossibility of any finite number of MCMC samples being able to "fill out" a posterior distribution that maintains a constant value to -infinity in log space. When there are zero flares, don't to be fooled into thinking there are lower limits on possible value for C and similar derived values. Use the MCMC sampling only to specify an upper limit on these values. Specifically, do not trust the result of ffd.utils.error_bars when applied to log10(C), etc. Instead, do, e.g., np.percentile(C, 95) to find an upper limit.

I reason through this as follows. With one flare in the dataset, both a lower and upper bound on the rate constant exist. I.e., the probability of C = 0 is 0 and the probability of C = infinity is 0, and by experimenting I have found that in-between the MCMC sampler can find a distribution in log10(C) that is fairly normal. With no flares, the probability of a given C value converges to a constant-nonzero value as C -> 0 and log10(C) -> -infinity. This comes straight from the Poisson distribution. If the expected event rate is zero (i.e. C = 0), the probability of observing zero events is 1. The resulting distribution in the rate constant becomes simply the exponential distribution, for which the max-likelihood value is 0 and it only makes sense to specify an upper limit on C (or log10(C) if preferred).
